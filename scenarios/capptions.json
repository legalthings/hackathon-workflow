{
  "$schema": "https://specs.livecontracts.io/v0.1.0/scenario/schema.json#",
  "id": "lt:/scenarios/5b9a4587-d5b3-4f81-a8f9-34f15d9ed258",
  "title": "Nutreco Certificate issue",
  "actors": {
    "inspector": {
      "title": "Inspector",
      "$ref": "https://specs.livecontracts.io/v0.1.0/actor/schema.json#organization",
      "role": "inspector"
    },
    "inspectee": {
      "title": "Inspectee",
      "$ref": "https://specs.livecontracts.io/v0.1.0/actor/schema.json#organization",
      "role": "inspectee"
    },
    "reviewer": {
      "title": "Back office Reviewer",
      "$ref": "https://specs.livecontracts.io/v0.1.0/actor/schema.json#organization",
      "role": "reviewer"
    }
  },
  "assets": {},
  "states": {
    ":initial": {
      "actions": [
        "invite_actors"
       ],
      "transitions": [
        {
          "action": "invite_actors",
          "transition": "invited_actors"
        }
      ]
    },
    "invited_actors": {
      "actions": [],
      "transitions": []
    },
    "inspected": {
      "actions": [],
      "transitions": []
    },
    "reviewed": {
      "actions": [],
      "transitions": []
    },
    "contract_ready": {
      "actions": [],
      "transitions": []
    },
    "certificate_ready": {
      "actions": [],
      "transitions": []
    },
    "state": {
      "actions": [],
      "transitions": []
    },
    "state": {
      "actions": [],
      "transitions": []
    },
    "state": {
      "actions": [],
      "transitions": []
    },
    "state": {
      "actions": [],
      "transitions": []
    },
    "state": {
      "actions": [],
      "transitions": []
    },
    "": {}
  },
  "actions": {
    "invite_actors": {
      "$schema": "https://specs.livecontracts.io/v0.1.0/action/schema.json#event",
      "actor": "inspector",
      "body": [
      {
        "$schema": "https://specs.livecontracts.io/v0.1.0/identity/schema.json#",
        "id": {
          "<ref>": "actors.inspectee.id"
        },
        "info": {
          "<ref>": "actors.inspectee.info"
        },
        "signkeys": {
          "<ref>": "actors.inspectee.signkeys"
        },
        "node": {
          "<ref>": "actors.inspectee.node"
        }
      },
      {
        "$schema": "https://specs.livecontracts.io/v0.1.0/identity/schema.json#",
        "id": {
          "<ref>": "actors.reviewer.id"
        },
        "info": {
          "<ref>": "actors.reviewer.info"
        },
        "signkeys": {
          "<ref>": "actors.reviewer.signkeys"
        },
        "node": {
          "<ref>": "actors.reviewer.node"
        }
      }
      ],
        "responses": {
          "ok": {
            "display": "never"
          },
          "error": {
            "display": "always",
            "title": "Failed to add the inspectee/reviewer"
          }
        }
    },
    "store_inspector_data": {
      "$schema": "https://specs.livecontracts.io/v0.1.0/action/schema.json#data",
      "actor": "inspector",
      "responses": {
        "ok": {
          "title": "Updated inspection data",
          "update": {
            "select": "assets.inspection_data",
            "patch": "true"
          }
        }
      }
    },
    "review_inspector_data": {
      "$schema": "https://specs.livecontracts.io/v0.1.0/action/schema.json#data",
      "actor": "reviewer",
      "responses": {
        "ok": {
          "display": "Accept"
        },
        "incomplete": {
          "display": "Request more data",
          "update": {
            "select": "feedback.review_feedback",
            "patch": false
          }
        },
        "rejected": {
          "display": "Reject",
          "update": {
            "select": "feedback.review_feedback",
            "patch": false
          }
        }
      }
    },
    "create_contract": {
      "$schema": "https://specs.livecontracts.io/v0.1.0/action/schema.json#http",
      "actor": "reviewer",
      "url": "https://app.docarama.com/service/docx/admin/documents",
      "method": "POST",
      "query": {},
      "headers": {
        "Content-Type": "application/json"
      },
      "data": {
        "template": "54a250c1-1a5f-4a97-a75c-4b466812a484",
        "organization_id: "5424879e22a903fd678b4570",
        "name": "Certificate",
        "values": {
          "<ref>": "assets.inspection_data"
        }
      },
      "responses": {
        "ok": {
          "display": "never",
          "title": "Contract created"
        },
        "error": {
          "display": "always",
          "title": "failed to create contract"
        }
      }
    },
    "create_certificate": {
      "$schema": "https://specs.livecontracts.io/v0.1.0/action/schema.json#http",
      "actor": "reviewer",
      "url": "https://app.docarama.com/service/docx/admin/documents",
      "method": "POST",
      "query": {},
      "headers": {
        "Content-Type": "application/json"
      },
      "data": {
        "template": "6c625dc9-cb31-4dd2-8c8f-ce1ad45fba65",
        "organization_id: "5424879e22a903fd678b4570",
        "name": "Certificate",
        "values": {
          "<ref>": "assets.inspection_data"
        }
      },
      "responses": {
        "ok": {
          "display": "never",
          "title": "Contract created"
        },
        "error": {
          "display": "always",
          "title": "failed to create contract"
        }
      }
    },
    "":{}
  }
}
